Traceback (most recent call last):
  File "C:\Users\nick9\anaconda3\Lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "C:\Users\nick9\anaconda3\Lib\site-packages\nbclient\client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nick9\anaconda3\Lib\site-packages\jupyter_core\utils\__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nick9\anaconda3\Lib\asyncio\base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Users\nick9\anaconda3\Lib\site-packages\nbclient\client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "C:\Users\nick9\anaconda3\Lib\site-packages\nbclient\client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\nick9\anaconda3\Lib\site-packages\nbclient\client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# Groepeer per land en product, tel alle waarden op
grouped = df.groupby(['Country', 'Product'])['Value'].sum().reset_index()

# Maak een draaitabel waarbij elke rij een land is
pivot = grouped.pivot(index='Country', columns='Product', values='Value').fillna(0)

# Voeg kolommen toe voor totaal per categorie
pivot['Fossiel'] = pivot[fossiel].sum(axis=1)
pivot['Duurzaam'] = pivot[duurzaam].sum(axis=1)

# Bereken het totale stroomverbruik per land (fossiel + duurzaam)
pivot['Totaal'] = pivot['Fossiel'] + pivot['Duurzaam']

# Bereken percentage duurzaam
pivot['% Duurzaam'] = (pivot['Duurzaam'] / pivot['Totaal']) * 100

# Sorteer van hoog naar laag
pivot_sorted = pivot.sort_values(by='% Duurzaam', ascending=False)


import matplotlib.pyplot as plt

# Pak top 10 landen met hoogste % duurzaam
top_duurzaam = pivot_sorted.head(10)

# Plot
plt.figure(figsize=(10, 6))
plt.barh(top_duurzaam.index[::-1], top_duurzaam['% Duurzaam'][::-1], color='#1b9e77')

plt.xlabel('Percentage duurzame elektriciteitsproductie')
plt.title('Top 10 landen met de schoonste stroommix (op basis van MES_0325.csv)')
plt.xlim(0, 100)
plt.grid(axis='x', linestyle='--', alpha=0.5)
plt.tight_layout()
plt.show()
------------------


[1;31m---------------------------------------------------------------------------[0m
[1;31mKeyError[0m                                  Traceback (most recent call last)
Cell [1;32mIn[5], line 2[0m
[0;32m      1[0m [38;5;66;03m# Groepeer per land en product, tel alle waarden op[39;00m
[1;32m----> 2[0m grouped [38;5;241m=[39m [43mdf[49m[38;5;241;43m.[39;49m[43mgroupby[49m[43m([49m[43m[[49m[38;5;124;43m'[39;49m[38;5;124;43mCountry[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mProduct[39;49m[38;5;124;43m'[39;49m[43m][49m[43m)[49m[[38;5;124m'[39m[38;5;124mValue[39m[38;5;124m'[39m][38;5;241m.[39msum()[38;5;241m.[39mreset_index()
[0;32m      4[0m [38;5;66;03m# Maak een draaitabel waarbij elke rij een land is[39;00m
[0;32m      5[0m pivot [38;5;241m=[39m grouped[38;5;241m.[39mpivot(index[38;5;241m=[39m[38;5;124m'[39m[38;5;124mCountry[39m[38;5;124m'[39m, columns[38;5;241m=[39m[38;5;124m'[39m[38;5;124mProduct[39m[38;5;124m'[39m, values[38;5;241m=[39m[38;5;124m'[39m[38;5;124mValue[39m[38;5;124m'[39m)[38;5;241m.[39mfillna([38;5;241m0[39m)

File [1;32m~\anaconda3\envs\jupyterbook\lib\site-packages\pandas\core\frame.py:9183[0m, in [0;36mDataFrame.groupby[1;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)[0m
[0;32m   9180[0m [38;5;28;01mif[39;00m level [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m by [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m   9181[0m     [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m([38;5;124m"[39m[38;5;124mYou have to supply one of [39m[38;5;124m'[39m[38;5;124mby[39m[38;5;124m'[39m[38;5;124m and [39m[38;5;124m'[39m[38;5;124mlevel[39m[38;5;124m'[39m[38;5;124m"[39m)
[1;32m-> 9183[0m [38;5;28;01mreturn[39;00m [43mDataFrameGroupBy[49m[43m([49m
[0;32m   9184[0m [43m    [49m[43mobj[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[43m,[49m
[0;32m   9185[0m [43m    [49m[43mkeys[49m[38;5;241;43m=[39;49m[43mby[49m[43m,[49m
[0;32m   9186[0m [43m    [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m,[49m
[0;32m   9187[0m [43m    [49m[43mlevel[49m[38;5;241;43m=[39;49m[43mlevel[49m[43m,[49m
[0;32m   9188[0m [43m    [49m[43mas_index[49m[38;5;241;43m=[39;49m[43mas_index[49m[43m,[49m
[0;32m   9189[0m [43m    [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[0;32m   9190[0m [43m    [49m[43mgroup_keys[49m[38;5;241;43m=[39;49m[43mgroup_keys[49m[43m,[49m
[0;32m   9191[0m [43m    [49m[43mobserved[49m[38;5;241;43m=[39;49m[43mobserved[49m[43m,[49m
[0;32m   9192[0m [43m    [49m[43mdropna[49m[38;5;241;43m=[39;49m[43mdropna[49m[43m,[49m
[0;32m   9193[0m [43m[49m[43m)[49m

File [1;32m~\anaconda3\envs\jupyterbook\lib\site-packages\pandas\core\groupby\groupby.py:1329[0m, in [0;36mGroupBy.__init__[1;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)[0m
[0;32m   1326[0m [38;5;28mself[39m[38;5;241m.[39mdropna [38;5;241m=[39m dropna
[0;32m   1328[0m [38;5;28;01mif[39;00m grouper [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m-> 1329[0m     grouper, exclusions, obj [38;5;241m=[39m [43mget_grouper[49m[43m([49m
[0;32m   1330[0m [43m        [49m[43mobj[49m[43m,[49m
[0;32m   1331[0m [43m        [49m[43mkeys[49m[43m,[49m
[0;32m   1332[0m [43m        [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m,[49m
[0;32m   1333[0m [43m        [49m[43mlevel[49m[38;5;241;43m=[39;49m[43mlevel[49m[43m,[49m
[0;32m   1334[0m [43m        [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[0;32m   1335[0m [43m        [49m[43mobserved[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[43mobserved[49m[43m [49m[38;5;129;43;01mis[39;49;00m[43m [49m[43mlib[49m[38;5;241;43m.[39;49m[43mno_default[49m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43mobserved[49m[43m,[49m
[0;32m   1336[0m [43m        [49m[43mdropna[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdropna[49m[43m,[49m
[0;32m   1337[0m [43m    [49m[43m)[49m
[0;32m   1339[0m [38;5;28;01mif[39;00m observed [38;5;129;01mis[39;00m lib[38;5;241m.[39mno_default:
[0;32m   1340[0m     [38;5;28;01mif[39;00m [38;5;28many[39m(ping[38;5;241m.[39m_passed_categorical [38;5;28;01mfor[39;00m ping [38;5;129;01min[39;00m grouper[38;5;241m.[39mgroupings):

File [1;32m~\anaconda3\envs\jupyterbook\lib\site-packages\pandas\core\groupby\grouper.py:1043[0m, in [0;36mget_grouper[1;34m(obj, key, axis, level, sort, observed, validate, dropna)[0m
[0;32m   1041[0m         in_axis, level, gpr [38;5;241m=[39m [38;5;28;01mFalse[39;00m, gpr, [38;5;28;01mNone[39;00m
[0;32m   1042[0m     [38;5;28;01melse[39;00m:
[1;32m-> 1043[0m         [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m(gpr)
[0;32m   1044[0m [38;5;28;01melif[39;00m [38;5;28misinstance[39m(gpr, Grouper) [38;5;129;01mand[39;00m gpr[38;5;241m.[39mkey [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[0;32m   1045[0m     [38;5;66;03m# Add key to exclusions[39;00m
[0;32m   1046[0m     exclusions[38;5;241m.[39madd(gpr[38;5;241m.[39mkey)

[1;31mKeyError[0m: 'Country'

